---
layout: single
title: "[Spring MVC] MVC ν”„λ μ„μ›ν¬"
permalink: /25
categories: [All, Spring]
toc: true
toc_sticky: true
toc_label: index
toc_icon: "fa-solid fa-indent"
author_profile: false
---

Model, View, Controller κµ¬μ„±μ”μ†λ¥Ό μ‚¬μ©ν•΄ ν΄λΌμ΄μ–ΈνΈμ μ”μ²­μ„ μ²λ¦¬ν•΄μ£Όλ” ν”„λ μ„μ›ν¬.

## Model

ν΄λΌμ΄μ–ΈνΈμ—κ² μ‘λ‹µμΌλ΅ λλ ¤μ£Όλ” **μ‘μ—…μ μ²λ¦¬ κ²°κ³Ό λ°μ΄ν„°**

<aside>
  
π’΅ ν΄λΌμ΄μ–ΈνΈμ μ”μ²­ μ‚¬ν•­μ„ κµ¬μ²΄μ μΌλ΅ μ²λ¦¬ν•λ” μμ—­μ„ **μ„λΉ„μ¤ κ³„μΈµ(Service Layer)** μ΄λΌ ν•λ©°, μ‹¤μ λ΅ μ”μ²­ μ‚¬ν•­μ„ μ²λ¦¬ν•κΈ° μ„ν•΄ Java μ½”λ“λ΅ κµ¬ν„ν• κ²ƒμ„ **λΉ„μ¦λ‹μ¤ λ΅μ§(Business Logic)** μ΄λΌ ν•λ‹¤.

</aside>

## View

Model λ°μ΄ν„°λ¥Ό μ΄μ©ν•΄μ„ μ›ΉλΈλΌμ°μ € κ°™μ€ **ν΄λΌμ΄μ–ΈνΈ μ• ν”λ¦¬μΌ€μ΄μ…μ ν™”λ©΄μ— λ³΄μ—¬μ§€λ” λ¦¬μ†μ¤λ¥Ό μ κ³µν•λ” μ—­ν• **

Spring MVCμ—λ” λ‹¤μ–‘ν• View κΈ°μ μ΄ ν¬ν•¨λμ–΄ μλ‹¤.

- **HTML νμ΄μ§€ μ¶λ ¥**
- **PDF, Excel λ“±μ λ¬Έμ„ ν•νƒλ΅ μ¶λ ¥**
- **XML, Json λ“± νΉμ • ν•μ‹μ ν¬λ§·μΌλ΅ λ³€ν™**

## Controller

ν΄λΌμ΄μ–ΈνΈ μΈ΅μ μ”μ²­μ„ μ§μ ‘μ μΌλ΅ μ „λ‹¬ λ°›λ” μ—”λ“ν¬μΈνΈλ΅μ¨ 

**Modelκ³Ό Viewμ μ¤‘κ°„μ—μ„ μƒνΈ μ‘μ©μ„ ν•΄μ£Όλ” μ—­ν• **

ν΄λΌμ΄μ–ΈνΈ μΈ΅μ μ”μ²­μ„ μ „λ‹¬λ°›μ•„ λΉ„μ¦λ‹μ¤ λ΅μ§μ„ κ±°μΉ ν›„,

Model λ°μ΄ν„°κ°€ λ§λ“¤μ–΄μ§€λ©΄, μ΄ Model λ°μ΄ν„°λ¥Ό Viewλ΅ μ „λ‹¬ν•λ” μ—­ν• μ„ ν•λ‹¤.

### Spring MVCμ λ™μ‘ λ°©μ‹κ³Ό κµ¬μ„± μ”μ†

![μ¤ν¬λ¦°μƒ·_20230213_101733](https://user-images.githubusercontent.com/77485397/218524029-b01e1b53-8e07-4471-a021-8da415d7d19c.png)

# Controller μ‹¬ν™”

## EntryPoint

Spring Boot κΈ°λ°μ μ• ν”λ¦¬μΌ€μ΄μ…μ΄ μ •μƒμ μΌλ΅ μ‹¤ν–‰λκΈ° μ„ν•΄μ„ λ¨Όμ € ν•΄μ•Όλ  μΌμ€ main() λ©”μ„λ“κ°€ ν¬ν•¨λ μ• ν”λ¦¬μΌ€μ΄μ…μ μ—”νΈλ¦¬ν¬μΈνΈ(μ‹μ‘μ )μ„ μ‘μ„±ν•λ” κ²ƒμ΄λ‹¤.

(μ—”νΈλ¦¬ν¬μΈνΈ ν΄λμ¤κ°€ μ΄λ―Έ μ‘μ„±λμ–΄ μμ)

```java
package test.demo;

import org.springframework.boot.SpringApplication;
import org.springframework.boot.autoconfigure.SpringBootApplication;

@SpringBootApplication
public class DemoApplication {

	public static void main(String[] args) {
		SpringApplication.run(DemoApplication.class, args); 
	}

}
```

<br>

**`@SpringBootApplication`**

- μλ™ κµ¬μ„±μ„ ν™μ„±ν™”ν•λ‹¤.
- μ• ν”λ¦¬μΌ€μ΄μ… ν¨ν‚¤μ§€ λ‚΄μ—μ„ `@Component`κ°€ λ¶™μ€ ν΄λμ¤λ¥Ό κ²€μƒ‰ν• ν›„(scan), Spring BeanμΌλ΅ λ“±λ΅ν•λ” κΈ°λ¥μ„ ν™μ„±ν™”ν•λ‹¤.
- `@Configuration`μ΄ λ¶™μ€ ν΄λμ¤λ¥Ό μλ™μΌλ΅ μ°Ύμ•„μ£Όκ³ , μ¶”κ°€μ μΌλ΅ Spring Beanμ„ λ“±λ΅ν•λ” κΈ°λ¥μ„ ν™μ„±ν™”ν•λ‹¤.

<br>

**`SpringApplication.run(DemoApplication.class, args);`**

- Spring μ• ν”λ¦¬μΌ€μ΄μ…μ„ λ¶€νΈμ¤νΈλ©ν•κ³ , μ‹¤ν–‰ν•λ” μ—­ν• μ„ ν•λ‹¤.

(λ¶€νΈμ¤νΈλ©(Bootstrap)μ€ μ• ν”λ¦¬μΌ€μ΄μ…μ΄ μ‹¤ν–‰λκΈ° μ „μ— μ—¬λ¬κ°€μ§€ μ„¤μ • μ‘μ—…μ„ μν–‰ν•μ—¬ μ‹¤ν–‰ κ°€λ¥ν• μ• ν”λ¦¬μΌ€μ΄μ…μΌλ΅ λ§λ“λ” λ‹¨κ³„λ¥Ό μλ―Έν•λ‹¤.)

<br>

**`@RestController`**

- MVCμ—μ„λ” νΉμ • ν΄λμ¤μ— `@RestController`λ¥Ό μ¶”κ°€ν•λ©΄ ν•΄λ‹Ή ν΄λμ¤κ°€ REST APIμ λ¦¬μ†μ¤λ¥Ό μ²λ¦¬ν•κΈ° μ„ν• API μ—”λ“ν¬μΈνΈλ΅ λ™μ‘ν•¨μ„ μ •μν•λ‹¤.
- `@RestController`κ°€ μ¶”κ°€λ ν΄λμ¤λ” μ• ν”λ¦¬μΌ€μ΄μ… λ΅λ”© μ‹, Spring BeanμΌλ΅ λ“±λ΅ν•΄μ¤€λ‹¤.

<br>

**`@RequestMapping`**

- ν΄λΌμ΄μ–ΈνΈμ μ”μ²­κ³Ό ν΄λΌμ΄μ–ΈνΈ μ”μ²­μ„ μ²λ¦¬ν•λ” **ν•Έλ“¤λ¬ λ©”μ„λ“(Handler Method)λ¥Ό λ§¤λΉ™**ν•΄μ£Όλ” μ—­ν• μ„ ν•λ‹¤.

<aside>
  
π’΅ `@RequestMapping`μ€ Controller ν΄λμ¤ λ λ²¨μ— μ¶”κ°€ν•μ—¬ ν΄λμ¤ μ „μ²΄μ— μ‚¬μ©λλ” **κ³µν†µ URL** μ„¤μ •μ„ ν•λ‹¤.
  
</aside>

<br>

<details>
<summary> REST APIλ€? </summary>
<div markdown="1">

**REST λ°©μ‹μ„ ν†µν•΄μ„ λ¦¬μ†μ¤μ— μ ‘κ·Όν•κΈ° μ„ν• μ„λΉ„μ¤ APIλ¥Ό μ§€μΉ­ν•λ‹¤.**

(RESTλ” HTTP λ„¤νΈμ›ν¬ μƒμ λ¦¬μ†μ¤λ¥Ό μ •μν•κ³  ν•΄λ‹Ή λ¦¬μ†μ¤λ¥Ό URLλΌλ” κ³ μ ν• μ£Όμ†λ΅ μ ‘κ·Όν•λ” λ°©μ‹μ„ μλ―Έν•λ‹¤.)

**REST API URL μ‘μ„± κ·μΉ™**

- URIμ λ§μ§€λ§‰μ΄ '/'λ΅ λλ‚μ§€ μ•μ•„μ•Ό ν•λ‹¤.
- λ™μ‚¬ λ³΄λ‹¤λ” λ…μ‚¬λ¥Ό μ‚¬μ©ν•λ‹¤.
    - http://www.itivllage.tistory.com/coffees (γ…‡)
    - http://www.itivllage.tistory.com/coffees/update (x)
- λ‹¨μν• λ³΄λ‹¤λ” λ³µμν• λ…μ‚¬λ¥Ό μ‚¬μ©ν•λ‹¤.
    - http://www.itivllage.tistory.com/coffees (γ…‡)
    - http://www.itivllage.tistory.com/coffee (x)
- URIλ” κΈ°λ³Έ μ†λ¬Έμλ΅ μ‚¬μ©ν•λ‹¤.
- μ–Έλ”μ¤μ½”μ–΄( _ ) λ€μ‹ μ— ν•μ΄ν”(-)μ„ μ‚¬μ©ν•λ‹¤.
- νμΌ ν™•μ¥μλ” URIμ— ν¬ν•¨ν•μ§€ μ•λ”.

</div>
</details>

<br>
<br>
<br>

# Handler Method ν•Έλ“¤λ¬ λ©”μ„λ“

**Controller ν΄λμ¤μ—μ„ ν΄λΌμ΄μ–ΈνΈμ μ”μ²­μ„ μ²λ¦¬ν•¨**

<br>

| Method Argument | μ„¤λ… |
| --- | --- |
| @RequestParam | μΏΌλ¦¬ νλΌλ―Έν„°, form-data λ“±μ Servlet request Parameterλ¥Ό λ°”μΈλ”© ν•΄μ•Ό ν•  κ²½μ° μ‚¬μ©ν•©λ‹λ‹¤. |
| @RequestHeader | request headerλ¥Ό λ°”μΈλ”©ν•΄μ„ headerμ key/valueμ— μ ‘κ·Όν•  μ μμµλ‹λ‹¤. |
| @RequestBody | request bodyλ¥Ό μ½μ–΄μ„ μ§€μ •ν• Java κ°μ²΄λ΅ deserialization ν•΄μ¤λ‹λ‹¤. |
| @RequestPart | 'multipart/form-data' ν•μ‹μ request λ°μ΄ν„°λ¥Ό part λ³„λ΅ λ°”μΈλ”©ν•  μ μλ„λ΅ ν•΄μ¤λ‹λ‹¤. |
| @PathVariable | @RequestMapping μ— ν¨ν„΄ ν•μ‹μΌλ΅ μ •μλ URLμ λ³€μμ— λ°”μΈλ”©ν•  μ μλ„λ΅ ν•΄μ¤λ‹λ‹¤. |
| @MatrixVariable | URL κ²½λ΅ μ„Έκ·Έλ¨ΌνΈ λ¶€λ¶„μ— key/value μμΌλ΅ λ λ°μ΄ν„°μ— λ°”μΈλ”©ν•  μ μλ„λ΅ ν•΄μ¤λ‹λ‹¤. |
| HttpEntity | request headerμ™€ bodyμ— μ ‘κ·Όν•  μ μλ” μ»¨ν…μ΄λ„ κ°μ²΄λ¥Ό μ‚¬μ©ν•  μ μμµλ‹λ‹¤. |
| javax.servlet.ServletRequest,Β javax.servlet.ServletResponse | λ΅μ° λ λ²¨μ ServeletRequestμ™€ ServletResponseμ μ •λ³΄κ°€ ν•„μ”ν•  λ• μ‚¬μ©ν•  μ μμµλ‹λ‹¤. |

<br>

```java
@RestController
@RequestMapping(value = "/v1/members", produces = {MediaType.APPLICATION_JSON_VALUE})
public class MemberController {
    @PostMapping
    public String postMember(@RequestParam("email") String email,
                             @RequestParam("name") String name,
                             @RequestParam("phone") String phone) {
        System.out.println("# email: " + email);
        System.out.println("# name: " + name);
        System.out.println("# phone: " + phone);
        
        String response =
                "{\"" + 
                   "email\":\""+email+"\"," + 
                   "\"name\":\""+name+"\",\"" + 
                   "phone\":\"" + phone+ 
                "\"}";
        return response;
    }

    @GetMapping("/{member-id}")
    public String getMember(@PathVariable("member-id")long memberId) {
        System.out.println("# memberId: " + memberId);

        // not implementation
        return null;
    }

    @GetMapping
    public String getMembers() {
        System.out.println("# get Members");

        // not implementation
        return null;
    }
}
```

μ¶”κ°€μ„¤λ… / ν΄λμ¤ λ λ²¨μ `@RequestMapping`μ— μ¶”κ°€λ ν•­λ©

- **produces**

`produces`μ• νΈλ¦¬λ·°νΈλ” μ‘λ‹µ λ°μ΄ν„°λ¥Ό μ–΄λ–¤ λ―Έλ””μ–΄ νƒ€μ…μΌλ΅ ν΄λΌμ΄μ–ΈνΈμ—κ² μ „μ†΅ν•  μ§€λ¥Ό μ„¤μ •ν•¨.

μ—¬κΈ°μ„λ” JSON ν•μ‹μ λ°μ΄ν„°λ¥Ό μ „μ†΅ν•κ² λ‹¤λ” μλ―Έλ΅ **`MediaType.APPLICATION_JSON_VALUE`** κ°’μ„

μ„¤μ •ν•¨.

- `postMember()` λ©”μ„λ“ (νμ› μ •λ³΄λ¥Ό λ“±λ΅ν•΄μ£Όλ” ν•Έλ“¤λ¬ λ©”μ„λ“)
    - `@PostMapping`μ€ ν΄λΌμ΄μ–ΈνΈμ μ”μ²­ λ°μ΄ν„°λ¥Ό μ„λ²„μ— μƒμ„±ν•  λ• μ‚¬μ©ν•λ” μ• λ„ν…μ΄μ… (HTTP Method νƒ€μ…κ³Ό λ™μΌν•κ² λ§μ¶°μ•Όν•λ‹¤.)

- `getMember()` λ©”μ„λ“ (νΉμ • νμ›μ μ •λ³΄λ¥Ό ν΄λΌμ΄μ–ΈνΈ μ½μ— μ κ³µν•λ” ν•Έλ“¤λ¬ λ©”μ„λ“)
    - `@GetMapping` μ€ ν΄λΌμ΄μ–ΈνΈκ°€ μ„λ²„μ— λ¦¬μ†μ¤λ¥Ό μ΅°νν•  λ• μ‚¬μ©ν•λ” μ• λ„ν…μ΄μ…

**ν•µμ‹¬**

---

- ν΄λΌμ΄μ–ΈνΈμ μ”μ²­μ„ μ „λ‹¬ λ°›μ•„μ„ μ²λ¦¬ν•κΈ° μ„ν•΄μ„λ” **μ”μ²­ ν•Έλ“¤λ¬ λ©”μ„λ“(Request Handler Method)**κ°€ ν•„μ”ν•λ‹¤.
- Spring MVCμ—μ„λ” HTTP Method μ ν•κ³Ό λ§¤μΉλλ” `@GetMapping`, `@PostMapping` λ“±μ μ• λ„ν…μ΄μ…μ„ μ§€μ›ν•λ‹¤.
- `@PathVariable` μ• λ„ν…μ΄μ…μ„ μ‚¬μ©ν•λ©΄ ν΄λΌμ΄μ–ΈνΈ μ”μ²­ URIμ— ν¨ν„΄ ν•μ‹μΌλ΅ μ§€μ •λ λ³€μμ κ°’μ„ νλΌλ―Έν„°λ΅ μ „λ‹¬λ°›μ„ μ μλ‹¤.
- `@RequestParam` μ• λ„ν…μ΄μ…μ„ μ‚¬μ©ν•λ©΄ μΏΌλ¦¬ νλΌλ―Έν„°(Query Parmeter λλ” Query string), νΌ λ°μ΄ν„°(form-data), x-www-form-urlencoded ν•μ‹μ λ°μ΄ν„°λ¥Ό νλΌλ―Έν„°λ΅ μ „λ‹¬ λ°›μ„ μ μλ‹¤.
- `@GetMapping`, `@PostMapping` λ“±μ—μ„ URIλ¥Ό μƒλµν•λ©΄ ν΄λμ¤ λ λ²¨μ URI κ²½λ΅λ§μΌλ΅ μ”μ²­ URIλ¥Ό κµ¬μ„±ν•λ‹¤.
